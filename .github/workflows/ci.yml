name: continuos integration
on:
  push:
    paths:
      - "src/**"
      - ".github/workflows/ci.yml"
      
jobs:
  gradle-build:
    name: Gradle build
    runs-on: [self-hosted]
    container:
      image: gradle:jdk17
    steps:
    - name: Check out commit
      uses: actions/checkout@v2
    - name: Wrapper
      run: |
        gradle wrapper -Dgradle.wrapperUser=${{secrets.JFROG_USER}} -Dgradle.wrapperPassword=${{secrets.JFROG_PASSWORD}}
      env:
        ARTIFACTORY_USER: ${{ secrets.JFROG_USER }}
        ARTIFACTORY_PASSWORD: ${{ secrets.JFROG_PASSWORD }}
    - name: List files
      run: ls $HOME
    - name: Build
      run: |
        ./gradlew build -Dgradle.wrapperUser=${{secrets.JFROG_USER}} -Dgradle.wrapperPassword=${{secrets.JFROG_PASSWORD}}
      env:
        ARTIFACTORY_USER: ${{ secrets.JFROG_USER }}
        ARTIFACTORY_PASSWORD: ${{ secrets.JFROG_PASSWORD }}
    ##- name: Publish
    ##  run: |
    ##    gradle artifactoryPublish
    ##  env:
    ##    ARTIFACTORY_USER: ${{ secrets.JFROG_USER }}
    ##    ARTIFACTORY_PASSWORD: ${{ secrets.JFROG_PASSWORD }}
